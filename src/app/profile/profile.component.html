<ng-container *ngIf="isError$ | async; else loadingOrContent">
  <app-resource-error-page
    title="Failed to Load Profile"
    subtitle="There was a problem retrieving the profile data. Please check your internet connection and try again."
    (onClick)="handleReload()"
  ></app-resource-error-page>
</ng-container>

<ng-template #loadingOrContent>
  <ng-container *ngIf="isLoading$ | async; else content">
    <section>
      <div class="skeleton-images-wrapper">
        <app-skeleton customClass="cover-image-skeleton"></app-skeleton>
        <div class="profile-image-skeleton-wrapper">
          <app-skeleton customClass="profile-image-skeleton"></app-skeleton>
        </div>
      </div>
      <div class="profile-info-skeleton">
        <app-skeleton customClass="username-skeleton"></app-skeleton>
        <app-skeleton customClass="date-skeleton"></app-skeleton>
        <div class="achievements-skeleton-wrapper">
          <app-skeleton customClass="achievement-skeleton"></app-skeleton>
          <app-skeleton customClass="achievement-skeleton"></app-skeleton>
          <app-skeleton customClass="achievement-skeleton"></app-skeleton>
        </div>
        <app-skeleton customClass="description-skeleton"></app-skeleton>
        <app-skeleton customClass="description-skeleton"></app-skeleton>
        <app-skeleton customClass="description-skeleton"></app-skeleton>
        <app-skeleton customClass="description-skeleton"></app-skeleton>
      </div>
    </section>
  </ng-container>
</ng-template>

<ng-template #content>
  <ng-container *ngIf="user$ | async as user; else noUser">
    <section>
      <app-images [user]="user" [isOwner]="isOwner"></app-images>
      <div class="profile-info-container">
        <h2>{{ user.username }}</h2>
        <div class="joined-date-wrapper">
          <lucide-angular size="15" [img]="Calendar"></lucide-angular>
          <p class="joined-date">
            Joined {{ user.createdAt | date : "longDate" }}
          </p>
        </div>
        <div class="achievements-wrapper">
          <div class="achievement-wrapper">
            <lucide-angular size="15" [img]="Utensils"></lucide-angular>
            <p>{{ user.totalReviews }} Reviews</p>
          </div>
          <div class="achievement-wrapper">
            <lucide-angular size="15" [img]="Heart"></lucide-angular>
            <p>{{ user.totalFavorites }} Favorites</p>
          </div>
          <div class="achievement-wrapper">
            <lucide-angular size="15" [img]="Award"></lucide-angular>
            <p>Top Reviewer</p>
          </div>
        </div>
      </div>
    </section>
  </ng-container>
</ng-template>

<ng-template #noUser>
  <app-resource-not-found-page
    title="Profile Not Found"
    subtitle="We couldn't find the profile you're looking for. The user with the specified ID doesn't exist in our database."
  ></app-resource-not-found-page
></ng-template>
